{% extends "templates/base.html" %}
{% load static %}

{% block content %}

<h2>Cadastrar Fornecedor</h2>

<!-- ERROS GERAIS DO FORM -->
{% if form.non_field_errors %}
<div class="alert alert-danger">
    {{ form.non_field_errors }}
</div>
{% endif %}

<script src="{% static 'javascript/cadastro_fornecedor.js' %}"></script>

<form method="POST">
    {% csrf_token %}

    <!-- =============================== -->
    <!-- DADOS DO FORNECEDOR -->
    <!-- =============================== -->
    <fieldset>
        <legend>Dados do Fornecedor</legend>

        <div class="form-grid">

            <div class="linha">
                <label>Nome fantasia</label>
                {{ form.nome_fantasia }}
                {% if form.nome_fantasia.errors %}
                    <div class="text-danger small">{{ form.nome_fantasia.errors }}</div>
                {% endif %}
            </div>

            <div class="linha">
                <label>Raz√£o social</label>
                {{ form.razao_social }}
                {% if form.razao_social.errors %}
                    <div class="text-danger small">{{ form.razao_social.errors }}</div>
                {% endif %}
            </div>

            <div class="linha">
                <label>CNPJ</label>
                {{ form.cnpj }}
                {% if form.cnpj.errors %}
                    <div class="text-danger small">{{ form.cnpj.errors }}</div>
                {% endif %}
            </div>

            <div class="linha">
                <label>Inscri√ß√£o estadual</label>
                {{ form.inscricao_estadual }}
                {% if form.inscricao_estadual.errors %}
                    <div class="text-danger small">{{ form.inscricao_estadual.errors }}</div>
                {% endif %}
            </div>

            <div class="linha">
                <label>Inscri√ß√£o municipal</label>
                {{ form.inscricao_municipal }}
                {% if form.inscricao_municipal.errors %}
                    <div class="text-danger small">{{ form.inscricao_municipal.errors }}</div>
                {% endif %}
            </div>

            <div class="linha">
                <label>Email</label>
                {{ form.email }}
                {% if form.email.errors %}
                    <div class="text-danger small">{{ form.email.errors }}</div>
                {% endif %}
            </div>

            <!-- TRANSPORTADORA -->
            <div class="linha">
                <label>Transportadora</label>
                <div class="input-com-lupa">
                    <input type="text" id="transportadora_input" name="transportadora_nome">
                    <input type="hidden" id="transportadora_id" name="transportadora">
                    <button type="button" class="btn-lupa"
                        id="btn-transportadora"
                        data-url="{% url 'busca:busca_transportadoras' %}">
                        üîç
                    </button>
                </div>
            </div>

            <!-- BANCO -->
            <div class="linha">
                <label>Banco</label>
                <div class="input-com-lupa">
                    <input type="text" id="banco_input" name="banco_nome">
                    <input type="hidden" id="banco_id" name="banco">
                    <button type="button" class="btn-lupa"
                        id="btn-banco"
                        data-url="{% url 'busca:busca_bancos' %}">
                        üîç
                    </button>
                </div>
            </div>

        </div>
    </fieldset>

    <hr>

    <!-- =============================== -->
    <!-- ENDERE√áOS -->
    <!-- =============================== -->
    <fieldset>
        <legend>Endere√ßos</legend>

        {{ endereco_fs.management_form }}

        {% for error in endereco_fs.non_form_errors %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endfor %}

        <div id="enderecos-container">
            {% for form in endereco_fs %}
            <div class="end-bloco form-grid">

                {{ form.id }}

                <div class="linha">
                    <label>Logradouro</label>
                    {{ form.logradouro }}
                    {% if form.logradouro.errors %}
                        <div class="text-danger small">{{ form.logradouro.errors }}</div>
                    {% endif %}
                </div>

                <div class="linha">
                    <label>N√∫mero</label>
                    {{ form.numero }}
                    {% if form.numero.errors %}
                        <div class="text-danger small">{{ form.numero.errors }}</div>
                    {% endif %}
                </div>

                <div class="linha">
                    <label>Bairro</label>
                    {{ form.bairro }}
                    {% if form.bairro.errors %}
                        <div class="text-danger small">{{ form.bairro.errors }}</div>
                    {% endif %}
                </div>

                <div class="linha">
                    <label>Cidade</label>
                    {{ form.cidade }}
                    {% if form.cidade.errors %}
                        <div class="text-danger small">{{ form.cidade.errors }}</div>
                    {% endif %}
                </div>

                <div class="linha">
                    <label>Estado</label>
                    {{ form.estado }}
                    {% if form.estado.errors %}
                        <div class="text-danger small">{{ form.estado.errors }}</div>
                    {% endif %}
                </div>

                <div class="linha">
                    <label>CEP</label>
                    {{ form.cep }}
                    {% if form.cep.errors %}
                        <div class="text-danger small">{{ form.cep.errors }}</div>
                    {% endif %}
                </div>

                <div class="linha delete-box">
                    <label>Excluir</label>
                    {{ form.DELETE }}
                </div>

            </div>
            <hr>
            {% endfor %}
        </div>

        <button type="button" id="add-endereco">+ Adicionar Endere√ßo</button>
    </fieldset>

    <hr>

    <!-- =============================== -->
    <!-- CONTATOS -->
    <!-- =============================== -->
    <fieldset>
        <legend>Contatos</legend>

        {{ contato_fs.management_form }}

        {% for error in contato_fs.non_form_errors %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endfor %}

        <div id="contatos-container">
            {% for form in contato_fs %}
            <div class="cont-bloco form-grid">

                {{ form.id }}

                <div class="linha">
                    <label>Nome</label>
                    {{ form.nome }}
                    {% if form.nome.errors %}
                        <div class="text-danger small">{{ form.nome.errors }}</div>
                    {% endif %}
                </div>

                <div class="linha">
                    <label>CPF</label>
                    {{ form.cpf }}
                    {% if form.cpf.errors %}
                        <div class="text-danger small">{{ form.cpf.errors }}</div>
                    {% endif %}
                </div>


                <div class="linha">
                    <label>Telefone</label>
                    {{ form.telefone }}
                    {% if form.telefone.errors %}
                        <div class="text-danger small">{{ form.telefone.errors }}</div>
                    {% endif %}
                </div>

                <div class="linha">
                    <label>Email</label>
                    {{ form.email }}
                    {% if form.email.errors %}
                        <div class="text-danger small">{{ form.email.errors }}</div>
                    {% endif %}
                </div>

                <div class="linha">
                    <label>Cargo</label>
                    {{ form.cargo }}
                    {% if form.cargo.errors %}
                        <div class="text-danger small">{{ form.cargo.errors }}</div>
                    {% endif %}
                </div>

                <div class="linha delete-box">
                    <label>Excluir</label>
                    {{ form.DELETE }}
                </div>

            </div>
            <hr>
            {% endfor %}
        </div>

        <button type="button" id="add-contato">+ Adicionar Contato</button>
    </fieldset>

    <!-- =============================== -->
    <!-- DEBUG (REMOVER DEPOIS) -->
    <!-- =============================== -->
    <pre>
FORM:
{{ form.errors }}

ENDERE√áOS:
{{ endereco_fs.errors }}

CONTATOS:
{{ contato_fs.errors }}
    </pre>

    <br>
    <button type="submit">Salvar</button>
</form>

{% endblock %}
